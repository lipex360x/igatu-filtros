import { PlopGeneratorConfig } from "plop"
import { CreateFileProps, generatorHandler, UpdateFileProps } from "../../core/handles"

export default<PlopGeneratorConfig> {
  description: 'Generate {{moduleName}}',

  prompts: [
    {
      type: 'input',
      name: 'componentName',
      message: 'Component Name',
      validate: (value: string) => (!value ? 'Value is required' : true),
    },
  ],

  actions: () => {
    const basePath = '../src/'
    const templatePath = './modules/{{moduleName}}/templates'

    const createFiles: CreateFileProps[] = [
      {
        path: `${basePath}/index.ts`,
        templateFile: `${templatePath}/index.hbs`,
      },
    ]

    const updateFiles: UpdateFileProps[] = [
      {
        path: `${basePath}/../index.ts`,
        template: `import * from '/index.ts'`,
      }
    ]

    return generatorHandler({createFiles, updateFiles})
  },
}